<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Warehouse Admin ‚Äî –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∫–ª–∞–¥–æ–º</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f0f2f5;
            color: #1a1a2e;
            min-height: 100vh;
        }

        /* ‚îÄ‚îÄ AUTH ‚îÄ‚îÄ */
        .auth-overlay {
            position: fixed; inset: 0;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            display: flex; align-items: center; justify-content: center;
            z-index: 1000;
        }
        .auth-card {
            background: white;
            border-radius: 16px;
            padding: 40px;
            width: 360px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .auth-card h2 { font-size: 22px; margin-bottom: 8px; }
        .auth-card p  { color: #666; font-size: 14px; margin-bottom: 24px; }

        /* ‚îÄ‚îÄ LAYOUT ‚îÄ‚îÄ */
        .sidebar {
            position: fixed; left: 0; top: 0; bottom: 0; width: 220px;
            background: #1a1a2e;
            padding: 24px 0;
            display: flex; flex-direction: column;
        }
        .sidebar-logo {
            padding: 0 20px 24px;
            font-size: 16px; font-weight: 700; color: white;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .sidebar-logo span { color: #e94560; }
        .nav-item {
            padding: 12px 20px;
            color: rgba(255,255,255,0.6);
            cursor: pointer;
            display: flex; align-items: center; gap: 10px;
            font-size: 14px;
            transition: all 0.2s;
            border-left: 3px solid transparent;
        }
        .nav-item:hover { color: white; background: rgba(255,255,255,0.05); }
        .nav-item.active { color: white; background: rgba(233,69,96,0.15); border-left-color: #e94560; }
        .nav-item .icon { font-size: 18px; width: 24px; text-align: center; }
        .sidebar-user {
            margin-top: auto;
            padding: 16px 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
            color: rgba(255,255,255,0.5);
            font-size: 13px;
        }

        .main { margin-left: 220px; padding: 32px; }

        .page { display: none; }
        .page.active { display: block; }

        /* ‚îÄ‚îÄ CARDS ‚îÄ‚îÄ */
        .page-header {
            display: flex; align-items: center; justify-content: space-between;
            margin-bottom: 24px;
        }
        .page-title { font-size: 24px; font-weight: 700; }
        .page-subtitle { color: #666; font-size: 14px; margin-top: 4px; }

        .card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            margin-bottom: 24px;
        }
        .card-title {
            font-size: 16px; font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid #f0f0f0;
        }

        /* ‚îÄ‚îÄ FORM ‚îÄ‚îÄ */
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }
        .form-group { display: flex; flex-direction: column; gap: 6px; }
        .form-group.full { grid-column: 1 / -1; }
        .form-group label { font-size: 13px; font-weight: 500; color: #555; }
        .form-control {
            padding: 10px 14px;
            border: 1.5px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.2s;
            outline: none;
            width: 100%;
        }
        .form-control:focus { border-color: #e94560; }
        select.form-control { background: white; cursor: pointer; }
        textarea.form-control { resize: vertical; min-height: 80px; }

        .photo-upload {
            border: 2px dashed #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }
        .photo-upload:hover { border-color: #e94560; background: #fff5f7; }
        .photo-upload input { position: absolute; inset: 0; opacity: 0; cursor: pointer; }
        .photo-upload .upload-icon { font-size: 28px; margin-bottom: 8px; }
        .photo-upload p { font-size: 13px; color: #888; }
        .photo-preview { max-width: 100%; max-height: 120px; border-radius: 6px; margin-top: 10px; display: none; }

        /* ‚îÄ‚îÄ BUTTONS ‚îÄ‚îÄ */
        .btn {
            padding: 10px 20px;
            border: none; border-radius: 8px;
            font-size: 14px; font-weight: 500;
            cursor: pointer; transition: all 0.2s;
        }
        .btn-primary { background: #e94560; color: white; }
        .btn-primary:hover { background: #c73652; }
        .btn-secondary { background: #f0f2f5; color: #333; }
        .btn-secondary:hover { background: #e0e2e5; }
        .btn-success { background: #10b981; color: white; }
        .btn-success:hover { background: #059669; }
        .btn-sm { padding: 6px 12px; font-size: 12px; }
        .btn-icon { padding: 6px 10px; font-size: 16px; }

        .form-actions {
            display: flex; gap: 12px; justify-content: flex-end;
            margin-top: 20px; padding-top: 20px;
            border-top: 1px solid #f0f0f0;
        }

        /* ‚îÄ‚îÄ TABLE ‚îÄ‚îÄ */
        .table-controls {
            display: flex; gap: 12px; margin-bottom: 16px; align-items: center;
        }
        .search-input {
            padding: 9px 14px;
            border: 1.5px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            outline: none;
            width: 260px;
            transition: border-color 0.2s;
        }
        .search-input:focus { border-color: #e94560; }

        table { width: 100%; border-collapse: collapse; }
        th {
            text-align: left; padding: 10px 14px;
            font-size: 12px; font-weight: 600;
            color: #888; text-transform: uppercase; letter-spacing: 0.5px;
            border-bottom: 2px solid #f0f0f0;
        }
        td {
            padding: 12px 14px;
            font-size: 14px;
            border-bottom: 1px solid #f7f7f7;
            vertical-align: middle;
        }
        tr:hover td { background: #fafafa; }
        .badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 12px; font-weight: 500;
        }
        .badge-blue  { background: #eff6ff; color: #3b82f6; }
        .badge-green { background: #f0fdf4; color: #16a34a; }
        .badge-gray  { background: #f3f4f6; color: #6b7280; }

        .qty { font-weight: 600; }
        .qty.low { color: #ef4444; }

        /* ‚îÄ‚îÄ STATS ‚îÄ‚îÄ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }
        .stat-label { font-size: 13px; color: #888; margin-bottom: 8px; }
        .stat-value { font-size: 28px; font-weight: 700; }
        .stat-sub   { font-size: 12px; color: #aaa; margin-top: 4px; }

        /* ‚îÄ‚îÄ SUCCESS MODAL ‚îÄ‚îÄ */
        .modal-overlay {
            position: fixed; inset: 0;
            background: rgba(0,0,0,0.5);
            display: flex; align-items: center; justify-content: center;
            z-index: 500; display: none;
        }
        .modal-overlay.show { display: flex; }
        .modal {
            background: white;
            border-radius: 16px;
            padding: 32px;
            width: 380px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
        }
        .modal-icon { font-size: 48px; margin-bottom: 16px; }
        .modal h3 { font-size: 20px; margin-bottom: 8px; }
        .modal p { color: #666; font-size: 14px; margin-bottom: 20px; }
        .qr-preview { width: 160px; height: 160px; border-radius: 8px; margin: 0 auto 20px; display: block; }

        /* ‚îÄ‚îÄ ALERT ‚îÄ‚îÄ */
        .alert {
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 16px;
            display: none;
        }
        .alert.show { display: block; }
        .alert-error   { background: #fef2f2; color: #dc2626; border: 1px solid #fee2e2; }
        .alert-success { background: #f0fdf4; color: #16a34a; border: 1px solid #dcfce7; }

        .empty-state {
            text-align: center; padding: 48px 20px; color: #aaa;
        }
        .empty-state .icon { font-size: 48px; margin-bottom: 12px; }
    </style>
</head>
<body>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê AUTH ‚ïê‚ïê -->
<div class="auth-overlay" id="authOverlay">
    <div class="auth-card">
        <h2>üîê –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
        <p>–í—Ö–æ–¥ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —Å–∫–ª–∞–¥–∞</p>
        <div class="form-group" style="margin-bottom:12px">
            <label>–õ–æ–≥–∏–Ω</label>
            <input type="text" id="authUsername" class="form-control" value="admin" placeholder="admin">
        </div>
        <div class="form-group" style="margin-bottom:20px">
            <label>–ü–∞—Ä–æ–ª—å</label>
            <input type="password" id="authPassword" class="form-control" value="admin123" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
        </div>
        <div id="authAlert" class="alert alert-error"></div>
        <button class="btn btn-primary" style="width:100%" onclick="adminLogin()">–í–æ–π—Ç–∏</button>
    </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SIDEBAR ‚ïê‚ïê -->
<div class="sidebar" id="sidebar" style="display:none">
    <div class="sidebar-logo">üì¶ Warehouse <span>Admin</span></div>
    <div class="nav-item active" onclick="showPage('dashboard')" id="nav-dashboard">
        <span class="icon">üìä</span> –î–∞—à–±–æ—Ä–¥
    </div>
    <div class="nav-item" onclick="showPage('create-item')" id="nav-create-item">
        <span class="icon">‚ûï</span> –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
    </div>
    <div class="nav-item" onclick="showPage('items')" id="nav-items">
        <span class="icon">üì¶</span> –ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤
    </div>
    <div class="nav-item" onclick="showPage('locations')" id="nav-locations">
        <span class="icon">üìç</span> –õ–æ–∫–∞—Ü–∏–∏
    </div>
    <div class="sidebar-user">
        üë§ <span id="sidebarUser"></span>
        <br><a href="#" onclick="adminLogout()" style="color:#e94560;font-size:12px">–í—ã—Ö–æ–¥</a>
    </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MAIN ‚ïê‚ïê -->
<div class="main" id="mainContent" style="display:none">

    <!-- ‚îÄ‚îÄ DASHBOARD ‚îÄ‚îÄ -->
    <div class="page active" id="page-dashboard">
        <div class="page-header">
            <div>
                <div class="page-title">–î–∞—à–±–æ—Ä–¥</div>
                <div class="page-subtitle">–û–±–∑–æ—Ä —Å–∫–ª–∞–¥–∞</div>
            </div>
        </div>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤</div>
                <div class="stat-value" id="statItems">‚Äî</div>
                <div class="stat-sub">–ø–æ–∑–∏—Ü–∏–π –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">–õ–æ–∫–∞—Ü–∏–π</div>
                <div class="stat-value" id="statLocations">‚Äî</div>
                <div class="stat-sub">—è—á–µ–µ–∫ –Ω–∞ —Å–∫–ª–∞–¥–µ</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">–ú–∞–ª–æ –Ω–∞ —Å–∫–ª–∞–¥–µ</div>
                <div class="stat-value" style="color:#ef4444" id="statLow">‚Äî</div>
                <div class="stat-sub">–º–µ–Ω–µ–µ 5 –µ–¥–∏–Ω–∏—Ü</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">–ö–∞—Ç–µ–≥–æ—Ä–∏–π</div>
                <div class="stat-value" id="statCategories">‚Äî</div>
                <div class="stat-sub">—Ç–∏–ø–æ–≤ –¥–µ—Ç–∞–ª–µ–π</div>
            </div>
        </div>
        <div class="card">
            <div class="card-title">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</div>
            <table>
                <thead><tr>
                    <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>SKU</th><th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                    <th>–ö–æ–ª-–≤–æ</th><th>–õ–æ–∫–∞—Ü–∏—è</th>
                </tr></thead>
                <tbody id="recentItemsTable">
                    <tr><td colspan="5" class="empty-state">–ó–∞–≥—Ä—É–∑–∫–∞...</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- ‚îÄ‚îÄ CREATE ITEM ‚îÄ‚îÄ -->
    <div class="page" id="page-create-item">
        <div class="page-header">
            <div>
                <div class="page-title">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</div>
                <div class="page-subtitle">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ ‚Äî QR —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</div>
            </div>
        </div>

        <div id="createAlert" class="alert"></div>

        <div class="card">
            <div class="card-title">–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
            <div class="form-grid">
                <div class="form-group">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ *</label>
                    <input type="text" id="itemName" class="form-control" placeholder="–ë–æ–ª—Ç –ú10 x 50">
                </div>
                <div class="form-group">
                    <label>SKU *</label>
                    <input type="text" id="itemSku" class="form-control" placeholder="SKU-001">
                </div>
                <div class="form-group">
                    <label>–ê—Ä—Ç–∏–∫—É–ª (Part Number)</label>
                    <input type="text" id="itemPartNumber" class="form-control" placeholder="PN-2024-001">
                </div>
                <div class="form-group">
                    <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <input type="text" id="itemCategory" class="form-control" placeholder="–ö—Ä–µ–ø—ë–∂, –§–∏–ª—å—Ç—Ä—ã, –ú–∞—Å–ª–∞..." list="categoryList">
                    <datalist id="categoryList"></datalist>
                </div>
                <div class="form-group">
                    <label>–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è</label>
                    <select id="itemUnit" class="form-control">
                        <option value="—à—Ç">—à—Ç ‚Äî —à—Ç—É–∫–∞</option>
                        <option value="–∫–≥">–∫–≥ ‚Äî –∫–∏–ª–æ–≥—Ä–∞–º–º</option>
                        <option value="–º">–º ‚Äî –º–µ—Ç—Ä</option>
                        <option value="–ª">–ª ‚Äî –ª–∏—Ç—Ä</option>
                        <option value="—É–ø">—É–ø ‚Äî —É–ø–∞–∫–æ–≤–∫–∞</option>
                        <option value="–∫–æ–º–ø–ª">–∫–æ–º–ø–ª ‚Äî –∫–æ–º–ø–ª–µ–∫—Ç</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>–õ–æ–∫–∞—Ü–∏—è –Ω–∞ —Å–∫–ª–∞–¥–µ</label>
                    <select id="itemLocation" class="form-control">
                        <option value="">‚Äî –ù–µ —É–∫–∞–∑–∞–Ω–∞ ‚Äî</option>
                    </select>
                </div>
                <div class="form-group full">
                    <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea id="itemDescription" class="form-control" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞..."></textarea>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-title">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞—Ä—Ç–∏–∏</div>
            <div class="form-grid">
                <div class="form-group">
                    <label>–ù–æ–º–µ—Ä –ø–∞—Ä—Ç–∏–∏ (Batch)</label>
                    <input type="text" id="itemBatchNumber" class="form-control" placeholder="BATCH-2024-01">
                </div>
                <div class="form-group">
                    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ –ø–∞—Ä—Ç–∏–∏</label>
                    <input type="number" id="itemBatchQty" class="form-control" placeholder="100" min="0">
                </div>
                <div class="form-group">
                    <label>–¢–µ–∫—É—â–∏–π –æ—Å—Ç–∞—Ç–æ–∫</label>
                    <input type="number" id="itemQuantity" class="form-control" placeholder="100" min="0">
                </div>
                <div class="form-group">
                    <label>–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø—Ä–∏—Ö–æ–¥–∞ –ø–∞—Ä—Ç–∏–∏</label>
                    <input type="datetime-local" id="itemArrivedAt" class="form-control">
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-title">–§–æ—Ç–æ –Ω–∞–∫–ª–∞–¥–Ω–æ–π</div>
            <div class="photo-upload" id="photoUploadArea">
                <input type="file" id="invoicePhoto" accept="image/*,application/pdf" onchange="previewPhoto(this)">
                <div class="upload-icon">üìÑ</div>
                <p>–ù–∞–∂–º–∏—Ç–µ –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–æ—Ç–æ –Ω–∞–∫–ª–∞–¥–Ω–æ–π</p>
                <p style="font-size:12px;margin-top:4px">JPG, PNG, PDF ‚Äî –¥–æ 20MB</p>
                <img id="photoPreview" class="photo-preview">
            </div>
        </div>

        <div style="display:flex;justify-content:flex-end;gap:12px">
            <button class="btn btn-secondary" onclick="resetCreateForm()">–û—á–∏—Å—Ç–∏—Ç—å</button>
            <button class="btn btn-primary" onclick="createItem()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ —Å–æ–∑–¥–∞—Ç—å QR</button>
        </div>
    </div>

    <!-- ‚îÄ‚îÄ ITEMS LIST ‚îÄ‚îÄ -->
    <div class="page" id="page-items">
        <div class="page-header">
            <div>
                <div class="page-title">–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</div>
                <div class="page-subtitle">–í—Å–µ –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ —Å–∫–ª–∞–¥–µ</div>
            </div>
            <button class="btn btn-primary" onclick="showPage('create-item')">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
        </div>
        <div class="card">
            <div class="table-controls">
                <input type="text" class="search-input" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, SKU, –∞—Ä—Ç–∏–∫—É–ª—É..." oninput="searchItems(this.value)">
                <select class="form-control" style="width:180px" onchange="filterByCategory(this.value)" id="categoryFilter">
                    <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                </select>
                <button class="btn btn-secondary btn-sm" onclick="loadItems()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
            </div>
            <table>
                <thead><tr>
                    <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>SKU</th><th>–ê—Ä—Ç–∏–∫—É–ª</th>
                    <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th><th>–ö–æ–ª-–≤–æ</th><th>–ï–¥.</th>
                    <th>–õ–æ–∫–∞—Ü–∏—è</th><th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr></thead>
                <tbody id="itemsTable">
                    <tr><td colspan="8" class="empty-state"><div class="icon">üì¶</div>–ó–∞–≥—Ä—É–∑–∫–∞...</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- ‚îÄ‚îÄ LOCATIONS ‚îÄ‚îÄ -->
    <div class="page" id="page-locations">
        <div class="page-header">
            <div>
                <div class="page-title">–õ–æ–∫–∞—Ü–∏–∏ —Å–∫–ª–∞–¥–∞</div>
                <div class="page-subtitle">–°—Ç–µ–ª–ª–∞–∂–∏, –ø–æ–ª–∫–∏, —è—á–µ–π–∫–∏</div>
            </div>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px">
            <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è -->
            <div class="card">
                <div class="card-title">‚ûï –î–æ–±–∞–≤–∏—Ç—å –ª–æ–∫–∞—Ü–∏—é</div>
                <div id="locationAlert" class="alert"></div>
                <div class="form-group" style="margin-bottom:12px">
                    <label>–ö–æ–¥ * (–Ω–∞–ø—Ä–∏–º–µ—Ä: A-01, B-02)</label>
                    <input type="text" id="locCode" class="form-control" placeholder="A-01">
                </div>
                <div class="form-group" style="margin-bottom:12px">
                    <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <input type="text" id="locDesc" class="form-control" placeholder="–°—Ç–µ–ª–ª–∞–∂ A, –ø–æ–ª–∫–∞ 1">
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-bottom:16px">
                    <div class="form-group">
                        <label>–†—è–¥</label>
                        <input type="text" id="locRow" class="form-control" placeholder="A">
                    </div>
                    <div class="form-group">
                        <label>–°–µ–∫—Ü–∏—è</label>
                        <input type="text" id="locSection" class="form-control" placeholder="1">
                    </div>
                    <div class="form-group">
                        <label>–ü–æ–ª–∫–∞</label>
                        <input type="text" id="locShelf" class="form-control" placeholder="2">
                    </div>
                </div>
                <button class="btn btn-primary" style="width:100%" onclick="createLocation()">
                    üìç –°–æ–∑–¥–∞—Ç—å –ª–æ–∫–∞—Ü–∏—é –∏ QR
                </button>
            </div>

            <!-- –°–ø–∏—Å–æ–∫ –ª–æ–∫–∞—Ü–∏–π -->
            <div class="card">
                <div class="card-title">–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ª–æ–∫–∞—Ü–∏–∏</div>
                <table>
                    <thead><tr>
                        <th>–ö–æ–¥</th><th>–û–ø–∏—Å–∞–Ω–∏–µ</th><th>QR</th>
                    </tr></thead>
                    <tbody id="locationsTable">
                        <tr><td colspan="3" class="empty-state">–ó–∞–≥—Ä—É–∑–∫–∞...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

</div><!-- /main -->

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SUCCESS MODAL ‚ïê‚ïê -->
<div class="modal-overlay" id="successModal">
    <div class="modal">
        <div class="modal-icon">‚úÖ</div>
        <h3 id="modalTitle">–¢–æ–≤–∞—Ä —Å–æ–∑–¥–∞–Ω!</h3>
        <p id="modalDesc">QR –∫–æ–¥ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Å–∫–∞—á–∏–≤–∞–Ω–∏—é</p>
        <img id="modalQR" class="qr-preview" src="" alt="QR –∫–æ–¥">
        <div style="display:flex;gap:10px;justify-content:center">
            <a id="modalDownload" href="#" download class="btn btn-success">‚¨áÔ∏è –°–∫–∞—á–∞—Ç—å QR</a>
            <button class="btn btn-secondary" onclick="closeModal();showPage('create-item')">‚ûï –ï—â—ë —Ç–æ–≤–∞—Ä</button>
            <button class="btn btn-secondary" onclick="closeModal();showPage('items')">üìã –ö —Å–ø–∏—Å–∫—É</button>
        </div>
    </div>
</div>

<script>
const API = '/api';
let token = null;
let currentUser = null;
let allItems = [];
let searchTimeout = null;

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê AUTH ‚ïê‚ïê
async function adminLogin() {
    const username = document.getElementById('authUsername').value;
    const password = document.getElementById('authPassword').value;
    const alert = document.getElementById('authAlert');

    try {
        const res = await fetch(`${API}/login`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ username, password })
        });
        const data = await res.json();

        if (data.success) {
            token = data.token;
            currentUser = data.username;
            document.getElementById('authOverlay').style.display = 'none';
            document.getElementById('sidebar').style.display = 'flex';
            document.getElementById('mainContent').style.display = 'block';
            document.getElementById('sidebarUser').textContent = currentUser;
            loadDashboard();
            loadLocationsForSelect();
            loadCategories();
        } else {
            showAlert(alert, data.error || '–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å', 'error');
        }
    } catch (e) {
        showAlert(alert, '–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è', 'error');
    }
}

function adminLogout() {
    token = null;
    document.getElementById('sidebar').style.display = 'none';
    document.getElementById('mainContent').style.display = 'none';
    document.getElementById('authOverlay').style.display = 'flex';
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê NAV ‚ïê‚ïê
function showPage(name) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
    document.getElementById('page-' + name).classList.add('active');
    const nav = document.getElementById('nav-' + name);
    if (nav) nav.classList.add('active');

    if (name === 'dashboard') loadDashboard();
    if (name === 'items') loadItems();
    if (name === 'locations') loadLocations();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê DASHBOARD ‚ïê‚ïê
async function loadDashboard() {
    try {
        const [itemsRes, locsRes, catsRes] = await Promise.all([
            fetch(`${API}/admin/items`),
            fetch(`${API}/admin/locations`),
            fetch(`${API}/admin/categories`)
        ]);
        const items = await itemsRes.json();
        const locs  = await locsRes.json();
        const cats  = await catsRes.json();

        const itemList = items.items || [];
        const low = itemList.filter(i => i.quantity < 5).length;

        document.getElementById('statItems').textContent = itemList.length;
        document.getElementById('statLocations').textContent = (locs.locations || []).length;
        document.getElementById('statLow').textContent = low;
        document.getElementById('statCategories').textContent = (cats.categories || []).length;

        const tbody = document.getElementById('recentItemsTable');
        const recent = itemList.slice(0, 8);
        if (recent.length === 0) {
            tbody.innerHTML = '<tr><td colspan="5" class="empty-state">–ù–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤</td></tr>';
        } else {
            tbody.innerHTML = recent.map(item => `
                <tr>
                    <td><strong>${item.name}</strong></td>
                    <td><span class="badge badge-gray">${item.sku}</span></td>
                    <td>${item.category ? `<span class="badge badge-blue">${item.category}</span>` : '‚Äî'}</td>
                    <td><span class="qty ${item.quantity < 5 ? 'low' : ''}">${item.quantity} ${item.unit || '—à—Ç'}</span></td>
                    <td>${item.location?.code || '‚Äî'}</td>
                </tr>
            `).join('');
        }
    } catch(e) { console.error(e); }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CREATE ITEM ‚ïê‚ïê
async function createItem() {
    const alert = document.getElementById('createAlert');

    const name = document.getElementById('itemName').value.trim();
    const sku  = document.getElementById('itemSku').value.trim();
    if (!name || !sku) {
        showAlert(alert, '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: –ù–∞–∑–≤–∞–Ω–∏–µ –∏ SKU', 'error');
        return;
    }

    const arrivedAt = document.getElementById('itemArrivedAt').value;

    const payload = {
        name,
        sku,
        description:     document.getElementById('itemDescription').value,
        quantity:        parseInt(document.getElementById('itemQuantity').value) || 0,
        unit:            document.getElementById('itemUnit').value,
        category:        document.getElementById('itemCategory').value,
        part_number:     document.getElementById('itemPartNumber').value,
        batch_number:    document.getElementById('itemBatchNumber').value,
        batch_quantity:  parseInt(document.getElementById('itemBatchQty').value) || 0,
        batch_arrived_at: arrivedAt || '',
        location_id:     document.getElementById('itemLocation').value,
    };

    try {
        const res = await fetch(`${API}/admin/item`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        });
        const data = await res.json();

        if (data.success) {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–æ—Ç–æ –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–æ
            const photoFile = document.getElementById('invoicePhoto').files[0];
            if (photoFile) {
                const form = new FormData();
                form.append('photo', photoFile);
                await fetch(`${API}/admin/item/${data.item.id}/photo`, {
                    method: 'POST', body: form
                });
            }

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª —Å QR
            document.getElementById('modalTitle').textContent = `–¢–æ–≤–∞—Ä "${data.item.name}" —Å–æ–∑–¥–∞–Ω!`;
            document.getElementById('modalDesc').textContent = `ID: ${data.item.id} ¬∑ SKU: ${data.item.sku}`;
            document.getElementById('modalQR').src = data.qr_url;
            document.getElementById('modalDownload').href = data.qr_url;
            document.getElementById('modalDownload').download = `qr_${data.item.id}.png`;
            document.getElementById('successModal').classList.add('show');

            resetCreateForm();
            loadCategories();
        } else {
            showAlert(alert, data.error || '–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è', 'error');
        }
    } catch(e) {
        showAlert(alert, '–û—à–∏–±–∫–∞: ' + e.message, 'error');
    }
}

function resetCreateForm() {
    ['itemName','itemSku','itemPartNumber','itemCategory','itemDescription',
     'itemBatchNumber','itemBatchQty','itemQuantity','itemArrivedAt'].forEach(id => {
        document.getElementById(id).value = '';
    });
    document.getElementById('itemUnit').value = '—à—Ç';
    document.getElementById('itemLocation').value = '';
    document.getElementById('invoicePhoto').value = '';
    document.getElementById('photoPreview').style.display = 'none';
    hideAlert(document.getElementById('createAlert'));
}

function previewPhoto(input) {
    const preview = document.getElementById('photoPreview');
    if (input.files && input.files[0]) {
        const file = input.files[0];
        if (file.type.startsWith('image/')) {
            const reader = new FileReader();
            reader.onload = e => {
                preview.src = e.target.result;
                preview.style.display = 'block';
            };
            reader.readAsDataURL(file);
        } else {
            preview.style.display = 'none';
            document.querySelector('.photo-upload p').textContent = 'üìÑ ' + file.name;
        }
    }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ITEMS LIST ‚ïê‚ïê
async function loadItems(search = '', category = '') {
    let url = `${API}/admin/items?`;
    if (search) url += `search=${encodeURIComponent(search)}&`;
    if (category) url += `category=${encodeURIComponent(category)}`;

    try {
        const res = await fetch(url);
        const data = await res.json();
        allItems = data.items || [];
        renderItemsTable(allItems);
    } catch(e) { console.error(e); }
}

function renderItemsTable(items) {
    const tbody = document.getElementById('itemsTable');
    if (!items.length) {
        tbody.innerHTML = '<tr><td colspan="8"><div class="empty-state"><div class="icon">üì¶</div>–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div></td></tr>';
        return;
    }
    tbody.innerHTML = items.map(item => `
        <tr>
            <td><strong>${item.name}</strong><br><small style="color:#aaa">${item.description || ''}</small></td>
            <td><span class="badge badge-gray">${item.sku}</span></td>
            <td style="color:#888">${item.part_number || '‚Äî'}</td>
            <td>${item.category ? `<span class="badge badge-blue">${item.category}</span>` : '‚Äî'}</td>
            <td><span class="qty ${item.quantity < 5 ? 'low' : ''}">${item.quantity}</span></td>
            <td>${item.unit || '—à—Ç'}</td>
            <td>${item.location?.code ? `<span class="badge badge-green">${item.location.code}</span>` : '‚Äî'}</td>
            <td>
                <a href="/api/admin/item/${item.id}/qr" download class="btn btn-sm btn-secondary" title="–°–∫–∞—á–∞—Ç—å QR">üì• QR</a>
            </td>
        </tr>
    `).join('');
}

function searchItems(val) {
    clearTimeout(searchTimeout);
    searchTimeout = setTimeout(() => {
        const cat = document.getElementById('categoryFilter').value;
        loadItems(val, cat);
    }, 300);
}

function filterByCategory(cat) {
    const search = document.querySelector('.search-input').value;
    loadItems(search, cat);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LOCATIONS ‚ïê‚ïê
async function loadLocations() {
    try {
        const res = await fetch(`${API}/admin/locations`);
        const data = await res.json();
        const locs = data.locations || [];
        const tbody = document.getElementById('locationsTable');
        if (!locs.length) {
            tbody.innerHTML = '<tr><td colspan="3" class="empty-state">–ù–µ—Ç –ª–æ–∫–∞—Ü–∏–π</td></tr>';
            return;
        }
        tbody.innerHTML = locs.map(loc => `
            <tr>
                <td><strong>${loc.code}</strong></td>
                <td style="color:#666">${loc.description || '‚Äî'}</td>
                <td>
                    <a href="/api/admin/location/${loc.id}/qr" download class="btn btn-sm btn-secondary">üì• QR</a>
                </td>
            </tr>
        `).join('');
    } catch(e) { console.error(e); }
}

async function loadLocationsForSelect() {
    try {
        const res = await fetch(`${API}/admin/locations`);
        const data = await res.json();
        const sel = document.getElementById('itemLocation');
        const locs = data.locations || [];
        locs.forEach(loc => {
            const opt = document.createElement('option');
            opt.value = loc.id;
            opt.textContent = `${loc.code} ‚Äî ${loc.description || ''}`;
            sel.appendChild(opt);
        });
    } catch(e) {}
}

async function createLocation() {
    const alert = document.getElementById('locationAlert');
    const code = document.getElementById('locCode').value.trim();
    if (!code) { showAlert(alert, '–£–∫–∞–∂–∏—Ç–µ –∫–æ–¥ –ª–æ–∫–∞—Ü–∏–∏', 'error'); return; }

    try {
        const res = await fetch(`${API}/admin/location`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                code,
                description: document.getElementById('locDesc').value,
                row:         document.getElementById('locRow').value,
                section:     document.getElementById('locSection').value,
                shelf:       document.getElementById('locShelf').value,
            })
        });
        const data = await res.json();
        if (data.success) {
            showAlert(alert, `–õ–æ–∫–∞—Ü–∏—è ${code} —Å–æ–∑–¥–∞–Ω–∞! QR –≥–æ—Ç–æ–≤.`, 'success');
            ['locCode','locDesc','locRow','locSection','locShelf'].forEach(id => document.getElementById(id).value = '');
            loadLocations();
            // –û–±–Ω–æ–≤–ª—è–µ–º select –≤ —Ñ–æ—Ä–º–µ —Ç–æ–≤–∞—Ä–∞
            const sel = document.getElementById('itemLocation');
            const opt = document.createElement('option');
            opt.value = data.location.id;
            opt.textContent = `${data.location.code} ‚Äî ${data.location.description || ''}`;
            sel.appendChild(opt);
        } else {
            showAlert(alert, data.error, 'error');
        }
    } catch(e) {
        showAlert(alert, '–û—à–∏–±–∫–∞: ' + e.message, 'error');
    }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CATEGORIES ‚ïê‚ïê
async function loadCategories() {
    try {
        const res = await fetch(`${API}/admin/categories`);
        const data = await res.json();
        const cats = data.categories || [];

        // datalist –¥–ª—è autocomplete
        const dl = document.getElementById('categoryList');
        dl.innerHTML = cats.map(c => `<option value="${c}">`).join('');

        // filter select
        const sel = document.getElementById('categoryFilter');
        const cur = sel.value;
        sel.innerHTML = '<option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>' +
            cats.map(c => `<option value="${c}" ${c===cur?'selected':''}>${c}</option>`).join('');
    } catch(e) {}
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê UTILS ‚ïê‚ïê
function showAlert(el, msg, type) {
    el.textContent = msg;
    el.className = `alert alert-${type} show`;
}
function hideAlert(el) {
    el.className = 'alert';
    el.textContent = '';
}
function closeModal() {
    document.getElementById('successModal').classList.remove('show');
}

// Enter –Ω–∞ —Ñ–æ—Ä–º–µ –ª–æ–≥–∏–Ω–∞
document.addEventListener('keydown', e => {
    if (e.key === 'Enter' && document.getElementById('authOverlay').style.display !== 'none') {
        adminLogin();
    }
});
</script>
</body>
</html>